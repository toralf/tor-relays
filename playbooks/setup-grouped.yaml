---
# "de-normalize" plays to
#   - if a linux kernel is compiled in background:
#     avoid reboot races by having all following steps already being applied (optimistic approach)
#   - saturize all forks by having 1 single play per host type

- name: Setup nonTor common
  hosts: "!snowflake:!tor"
  roles:
    - role: poweron
      tags:
        - never
    - role: setup_common
    - role: info_healthy
    - role: setup_autoupdate

- name: Setup snowflake
  hosts: snowflake
  roles:
    - role: setup_common
    - role: info_healthy
    - role: setup_snowflake
    - role: setup_autoupdate

- name: Setup tor
  hosts: tor
  roles:
    - role: setup_common
    - role: info_healthy
    - role: setup_tor
    - role: setup_autoupdate
