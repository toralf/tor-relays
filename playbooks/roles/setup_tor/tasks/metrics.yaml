---
- name: Download DDoS metrics script
  throttle: 50
  retries: 3
  when: tor_metrics_ddos
  ansible.builtin.get_url:
    url: "https://github.com/toralf/torutils/raw/main/metrics.sh"
    dest: "/root/metrics.sh"
    mode: "0744"
    force: true

- name: Create cron job to create DDoS metrics
  ansible.builtin.cron:
    name: "DDoS metrics"
    special_time: reboot
    job: "/root/metrics.sh 1>/dev/null 2>&1"
    state: "{{ tor_metrics_ddos | ternary('present', 'absent') }}"
