---
- name: Validate IPv6 address
  ansible.builtin.assert:
    quiet: true
    that:
      - "ansible_facts.default_ipv6.address is not match('fe80::')"
      - "ansible_facts.default_ipv6.address is not search('::1$')"

- name: Validate tor_port
  ansible.builtin.assert:
    quiet: true
    that:
      - "tor_port > 0 and tor_port < 2**16"

- name: Validate metrics_port
  when: metrics_port != 0
  ansible.builtin.assert:
    quiet: true
    that:
      - "metrics_port > 0 and metrics_port < 2**16"
      - "tor_port != metrics_port"

- name: Validate tor_port
  when: tor_port != 0
  ansible.builtin.assert:
    quiet: true
    that:
      - "tor_port > 0 and tor_port < 2**16"

- name: Validate nickname
  when: nickname | length > 0
  ansible.builtin.assert:
    quiet: true
    that:
      - "nickname | length >= 1 and nickname | length <= 19"

- name: Validate additional_ports
  when: additional_ports | length > 0
  ansible.builtin.assert:
    quiet: true
    that:
      - "additional_ports | unique | length == additional_ports | length"
