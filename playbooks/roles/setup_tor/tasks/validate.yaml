---
- name: Validate nickname
  when: nickname
  ansible.builtin.assert:
    quiet: true
    that:
      - "nickname | length <= 19"
      - "nickname | regex_search('^[a-zA-Z0-9]+$')"

- name: Validate tor_port
  ansible.builtin.assert:
    quiet: true
    that:
      - "tor_port is defined"
      - "(tor_port | int > 0) and (tor_port | int < 2**16)"

- name: Validate metrics_port
  when: metrics_port
  ansible.builtin.assert:
    quiet: true
    that:
      - metrics_port != tor_port
