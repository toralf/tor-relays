---
- name: Configure torrc
  ansible.builtin.template:
    src: torrc.j2
    dest: /etc/tor/torrc
  register: _config

- name: Restart Tor service
  ansible.builtin.service:
    name: tor
    state: restarted
    daemon_reload: true
  when: force_restart or _config.changed

- name: Ensure Tor service is started
  ansible.builtin.service:
    name: tor
    state: started
    daemon_reload: true
    enabled: true
