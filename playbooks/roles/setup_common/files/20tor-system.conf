# common
kernel.sysrq = 0
net.ipv4.tcp_fin_timeout = 10
net.ipv4.tcp_notsent_lowat = 131072
net.ipv4.tcp_syncookies = 1
net.ipv6.ip_nonlocal_bind = 1

# Hints:
#   User namespaces are needed for Snowflake systemd restart.
#   Modules are needed to boot a distribution kernel.
#   PTRACE_ATTACH must be 1 for minicoredumper
#   https://kspp.github.io/Recommended_Settings#sysctls

kernel.kptr_restrict = 2
kernel.dmesg_restrict = 1
kernel.perf_event_paranoid = 3
kernel.kexec_load_disabled = 1
kernel.randomize_va_space = 2
dev.tty.ldisc_autoload = 0
dev.tty.legacy_tiocsti = 0
kernel.unprivileged_bpf_disabled = 1
kernel.oops_limit = 1
net.core.bpf_jit_harden = 2
vm.unprivileged_userfaultfd = 0
fs.protected_symlinks = 1
fs.protected_hardlinks = 1
fs.protected_fifos = 2
fs.protected_regular = 2
fs.suid_dumpable = 0
