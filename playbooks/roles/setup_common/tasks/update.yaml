---
- name: Upgrade dist
  ansible.builtin.apt:
    update_cache: true
    upgrade: dist

- name: Install or update common software
  ansible.builtin.apt:
    name:
      - needrestart
      - psmisc
      - python3-psutil
      - rsync

- name: Install or update additional software
  when: additional_software
  ansible.builtin.apt:
    name: "{{ additional_software }}"

# openipmi might be a left over from earlier IONOS install images
- name: De-install openipmi
  ansible.builtin.apt:
    state: absent
    name:
      - freeipmi-common
