---
- name: Validate OS
  ansible.builtin.assert:
    quiet: true
    that:
      - "ansible_facts.distribution in ('Debian', 'Ubuntu')"

- name: Validate metrics_port
  when: metrics_port
  ansible.builtin.assert:
    quiet: true
    that:
      - "metrics_port | int > 0 and metrics_port | int < 2**16"

- name: Validate prometheus_server
  when: prometheus_server
  ansible.builtin.assert:
    quiet: true
    that:
      - "prometheus_server is ansible.utils.ipv4"

- name: Validate prometheus_server IPv6
  when: prometheus_server6
  ansible.builtin.assert:
    quiet: true
    that:
      - "prometheus_server6 is ansible.utils.ipv6"

- name: Validate RAM for kernel src
  when: kernel_git_version
  ansible.builtin.assert:
    quiet: true
    that:
      - "ansible_facts.memtotal_mb > 1024"

- name: Check Boolean values
  ansible.builtin.assert:
    quiet: true
    that:
      - "kernel_debian_backports in ('true', 'false') or kernel_debian_backports in (true, false)"
      - "kernel_debian_cloud in ('true', 'false') or kernel_debian_cloud in (true, false)"
      - "fire_and_forget in ('true', 'false') or fire_and_forget in (true, false)"
      - "nginx_metrics in ('true', 'false') or nginx_metrics in (true, false)"
      - "node_metrics in ('true', 'false') or node_metrics in (true, false)"
      - "nginx_listener_default in ('true', 'false') or nginx_listener_default in (true, false)"
