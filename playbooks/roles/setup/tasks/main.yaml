---

- name: Main
  module_defaults:
    ansible.builtin.apt:
      state: latest
      cache_valid_time: 600
    ansible.builtin.copy:
      owner: root
      group: root
      mode: 0644
    ansible.builtin.file:
      owner: root
      group: root
      mode: 0644
    ansible.builtin.template:
      owner: root
      group: root
      mode: 0644
  block:
    - name: System
      ansible.builtin.import_tasks: system.yaml
      tags:
        - system

    - name: Timer
      ansible.builtin.import_tasks: timer.yaml
      tags:
        - timer

    - name: Tor
      ansible.builtin.import_tasks: tor.yaml
      tags:
        - tor

    - name: Hint
      ansible.builtin.import_tasks: hint.yaml
      when: contact_info is defined
      tags:
        - hint

    - name: Reboot
      ansible.builtin.import_tasks: reboot.yaml
      tags:
        - reboot

    - name: Restart
      ansible.builtin.import_tasks: restart.yaml
      tags:
        - never
        - restart
