---
- name: Validate ipv6 being available
  ansible.builtin.assert:
    quiet: true
    that:
      - "ansible_facts.default_ipv6.address is defined"
      - "ansible_facts.default_ipv6.address is not match('fe80::')"

- name: Validate metrics_port
  when: metrics_port | length > 0
  ansible.builtin.assert:
    quiet: true
    that:
      - "(metrics_port | int > 0) and (metrics_port | int < 2**16)"

- name: Validate prometheus_server
  when: prometheus_server | length > 0
  ansible.builtin.assert:
    quiet: true
    that:
      - "{{ item }} is ansible.utils.ipv4"
  with_items: "{{ prometheus_server | split(',') }}"
