---
- name: Validate metrics_port
  when: metrics_port is defined
  ansible.builtin.assert:
    quiet: true
    that:
      - "(metrics_port | int > 0) and (metrics_port | int < 2**16)"
      - "prometheus_server is defined"

- name: Validate prometheus_server
  when: prometheus_server is defined
  ansible.builtin.assert:
    quiet: true
    that:
      - "metrics_port is defined"
      - "prometheus_server is ansible.utils.ipv4"

- name: Validate kernel_debian_repo
  when: kernel_debian_repo != ""
  ansible.builtin.assert:
    quiet: true
    that:
      - "kernel_debian_version is defined"
      - 'kernel_debian_version != ""'

- name: Validate kernel_debian_version
  when: kernel_debian_version != ""
  ansible.builtin.assert:
    quiet: true
    that:
      - "kernel_debian_repo is defined"
      - 'kernel_debian_repo != ""'
