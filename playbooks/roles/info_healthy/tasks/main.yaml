---
- name: Main
  module_defaults:
    ansible.builtin.blockinfile:
      create: true
      mode: "0644"
    ansible.builtin.copy:
      mode: "0644"
    ansible.builtin.fetch:
      flat: true
    ansible.builtin.lineinfile:
      create: true
      firstmatch: true
      mode: "0644"
  block:
    - name: Artefact
      ansible.builtin.import_tasks: artefact.yaml
      tags:
        - artefact

    - name: IPv6
      ansible.builtin.import_tasks: ipv6.yaml
      tags:
        - ipv6-healthy

    - name: Issue
      ansible.builtin.import_tasks: issue.yaml
      tags:
        - issue

    - name: Get kernel config
      ansible.builtin.import_tasks: _kernel-config.yaml
      tags:
        - kernel-config
        - never

    - name: Kernel trace
      ansible.builtin.import_tasks: trace.yaml
      tags:
        - trace

    - name: Minicoredumper
      ansible.builtin.import_tasks: minicoredumper.yaml
      tags:
        - minicoredumper
