---
- name: Minicoredumper
  changed_when: _result.files is defined and _result.files | length > 0
  ansible.builtin.find:
    paths:
      - /var/crash/minicoredumper
    patterns:
      - core.tar.gz
    recurse: true
  register: _result

- name: Loop over core dump files
  when: _result.files is defined and _result.files | length > 0
  vars:
    _fname: "{{ item.path }}"
    _unique_id: "{{ inventory_hostname }}.{{ _fname | dirname | basename }}"
  ansible.builtin.include_tasks: _minicoredumper.yaml
  loop_control:
    label: "{{ _unique_id }}"
  loop: "{{ _result.files }}"
