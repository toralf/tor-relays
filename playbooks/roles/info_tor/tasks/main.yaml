---
- name: Main
  module_defaults:
    ansible.builtin.lineinfile:
      create: yes
  block:
    - name: Get fingerprints
      ansible.builtin.import_tasks: fingerprints.yaml
      tags:
        - bridgeline
        - bto
        - onionoo
        - wellknown

    - name: Bridge line
      when: bridge_distribution
      ansible.builtin.import_tasks: bridgeline.yaml
      tags:
        - never
        - bridgeline

    - name: Bto
      when: bridge_distribution
      ansible.builtin.import_tasks: bto.yaml
      tags:
        - bto

    - name: Clients
      when: bridge_distribution
      ansible.builtin.import_tasks: clients.yaml
      tags:
        - clients

    - name: Log
      ansible.builtin.import_tasks: log-notice.yaml
      tags:
        - log
        - log-notice

    - name: Log warn
      ansible.builtin.import_tasks: log-warn.yaml
      tags:
        - log
        - log-warn

    - name: Log err
      ansible.builtin.import_tasks: log-err.yaml
      tags:
        - log
        - log-err

    - name: Onionoo
      when: bridge_distribution
      ansible.builtin.import_tasks: onionoo.yaml
      tags:
        - onionoo

    - name: Uptime
      ansible.builtin.import_tasks: uptime.yaml
      tags:
        - uptime

    - name: Version of Tor
      ansible.builtin.import_tasks: version.yaml
      tags:
        - version

    - name: Wellknown
      ansible.builtin.import_tasks: wellknown.yaml
      tags:
        - wellknown
