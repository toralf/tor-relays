---
- name: Get proxy log
  changed_when: false
  ansible.builtin.shell:
    cmd: |-
      journalctl -u {{ item.name }} --since "{{ log_proxy_since }}" --quiet |
        grep -F -v \
          -e ' client connected' \
          -e ' completed successful connections.' \
          -e ' completed connections.' \
          -e ' Proxy connection closed' |
        tail -n {{ log_lines }}
  register: _result

- name: Results of proxy log
  when: _result.stdout | length > 0
  changed_when: true
  ansible.builtin.debug:
    var: _result.stdout_lines
